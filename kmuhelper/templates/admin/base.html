{% extends "admin/base.html" %}

{% block extrahead %}
    <script>
        if (window.hasOwnProperty("django")) {
            window.addEventListener("load", function () {
                var isSubmitting = false;
                var $ = django.jQuery;

                $(document).ready(function () {
                    $('form').submit(function (event) {
                        if (!(event.target.id === "changelist-search")) {
                            isSubmitting = true;
                            console.log("Form submitted...");
                        } else {
                            console.log("Search submitted...");
                        }
                    })

                    $('form').not("#changelist-search").data('initial-state', $('form').not("#changelist-search").serialize());

                    $(window).on('beforeunload', function () {
                        if (!isSubmitting && $('form').not("#changelist-search").serialize() != $('form').not("#changelist-search").data('initial-state')) {
                            return 'Du hast ungesicherte Änderungen vorgenommen. Wenn du die Seite verlässt, werden diese gelöscht.'
                        }
                    });
                })
            })
        }
    </script>
    {{ block.super }}
{% endblock %}
